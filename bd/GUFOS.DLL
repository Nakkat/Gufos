CREATE DATABASE Gufos;

USE Gufos;

CREATE TABLE TipoUsuario(
	IdTipoUsuario INT IDENTITY PRIMARY KEY,
	Titulo VARCHAR (255) UNIQUE NOT NULL
);

CREATE TABLE Usuario(
	IdUsuario INT IDENTITY PRIMARY KEY,
	Nome VARCHAR (255) NOT NULL,
	Email VARCHAR (255) UNIQUE NOT NULL,
	Senha VARCHAR (255) NOT NULL,
	IdTipoUsuario INT FOREIGN KEY REFERENCES TipoUsuario (IdTipoUSuario)
);

CREATE TABLE Localizacao(
	IdLocalizacao INT IDENTITY PRIMARY KEY,
	CNPJ CHAR (14) UNIQUE NOT NULL,
	RazaoSocial VARCHAR (255) UNIQUE NOT NULL,
	Endereco VARCHAR (255) NOT NULL
);

CREATE TABLE Categoria (
	IdCategoria INT IDENTITY PRIMARY KEY,
	Titulo VARCHAR (255) UNIQUE NOT NULL
);

CREATE TABLE Eventos (
	IdEvento INT IDENTITY PRIMARY KEY,
	Titulo VARCHAR (255) NOT NULL,
	IdCategoria INT FOREIGN KEY REFERENCES Categoria(IdCategoria),
	AcessoLivre BIT DEFAULT(1) NOT NULL, -- Bit - Boll - Se o usuário digitar 1 - Acesso livre
	DataEvento DATETIME NOT NULL,
	IdLocalizacao INT FOREIGN KEY REFERENCES Localizacao(IdLocalizacao)
);

CREATE TABLE Presenca (
	IdPresenca INT IDENTITY PRIMARY KEY,
	IdEvento INT FOREIGN KEY REFERENCES Eventos (IdEvento),
	IdUsuario INT FOREIGN KEY REFERENCES Usuario (IdUsuario),
	PresencaStatus VARCHAR (255) NOT NULL
);